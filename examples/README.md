# OpenTDF Platform Examples

Examples demonstrating the usage of the OpenTDF Platform Services.

These examples can be launched using an example CLI.
[See the autogenerated cobra docs](./docs/examples.md).

## Building the Examples CLI

```shell
go build -o examples-cli
```

## Quick Start

```shell
# List attributes
./examples-cli attributes ls

# Show assertion provider examples
./examples-cli assertion --help

# Run encryption example
./examples-cli encrypt sensitive.txt -o sensitive.txt.tdf
```

## Available Examples

### Core Services
- [Attribute Service](./cmd/attributes.go) - Manage and query data attributes
- [Authorization Service](./cmd/authorization.go) - Authorization and access control

### Assertion Providers
- [Assertion Providers](./cmd/assertion.go) - Custom signing and validation providers
  - Default provider (backward compatible)
  - X.509 certificate provider (PIV/CAC support)
  - Hardware token provider (YubiKey, CAC cards)
  - Custom validation providers
  - Hybrid validation (multiple methods)

### Encryption & Decryption
- [Encrypt](./cmd/encrypt.go) - Create encrypted TDF files
- [Decrypt](./cmd/decrypt.go) - Decrypt TDF files
- [IsValid](./cmd/isvalid.go) - Validate TDF files

### Key Access Service (KAS)
- [KAS Operations](./cmd/kas.go) - Key access service operations

### Benchmarking
- [Benchmark](./cmd/benchmark.go) - Performance benchmarking
- [Benchmark Bulk](./cmd/benchmark_bulk.go) - Bulk operation benchmarks
- [Decision Benchmarks](./cmd/benchmark_decision.go) - Decision service benchmarks

## Assertion Provider Examples

The assertion provider examples demonstrate how to implement custom signing and validation for TDF assertions, enabling support for hardware security modules, smart cards, and flexible validation strategies.

### Running Assertion Provider Examples

```shell
# Show all available assertion provider commands
./examples-cli assertion --help

# Run the default provider example (backward compatible)
./examples-cli assertion default

# Demonstrate X.509 certificate-based signing (PIV/CAC support)
./examples-cli assertion x509
./examples-cli assertion x509 --details  # Show certificate details

# Show hardware token provider implementation
./examples-cli assertion hardware --details

# Demonstrate custom validation with trust policies
./examples-cli assertion validation

# Show hybrid validation combining multiple methods
./examples-cli assertion hybrid
```

### Key Features Demonstrated

1. **Default Provider** - Shows existing key-based signing (100% backward compatible)
2. **X.509 Provider** - Certificate-based signing for PIV/CAC cards
3. **Hardware Provider** - Integration with YubiKey, CAC cards via PKCS#11
4. **Custom Validation** - X.509 validation with Federal PKI trust anchors
5. **Hybrid Validation** - Combines multiple validation methods with fallback

### Use Cases

- **Government/Military**: PIV/CAC card integration for classified data
- **Enterprise**: Hardware security module (HSM) integration
- **Migration**: Gradual transition from key-based to certificate-based authentication
- **Compliance**: Meet NIST SP 800-78, FIPS 201, NATO STANAG 4774 requirements

### Implementation Details

The provider interfaces allow developers to:
- Implement custom signing logic without modifying core SDK
- Support hardware tokens that never expose private keys
- Validate assertions using custom trust models
- Maintain backward compatibility while adding new capabilities

For full implementation details, see:
- [Provider Interfaces](../sdk/assertion_provider.go)
- [Default Implementation](../sdk/assertion_default_provider.go)
- [X.509 Implementation](../sdk/assertion_x5c_provider.go)
- [Provider Tests](../sdk/assertion_provider_test.go)

## Configuration Options

The examples CLI supports various configuration options:

```shell
# Platform connection options
./examples-cli --platformEndpoint https://your-platform.example.com \
              --creds client-id:client-secret \
              --tokenEndpoint https://auth.example.com/token

# Security options
./examples-cli --insecureSkipVerify    # Skip TLS verification (dev only)
./examples-cli --insecurePlaintextConn # Use plaintext connection (dev only)

# Example with full configuration
./examples-cli assertion x509 \
              --platformEndpoint https://platform.example.com \
              --creds myapp:mysecret \
              --details
```

## Environment Setup

For local development and testing:

```shell
./examples-cli --platformEndpoint "http://localhost:8080" --creds "opentdf:secret" attributes ls
```
